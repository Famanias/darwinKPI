<div class="dashboard-container p-6">
  <h2 class="text-2xl font-bold mb-4">My Dashboard</h2>

  <!-- Attention Required -->
  <div class="bg-yellow-100 p-4 rounded mb-4" *ngIf="attentionRequired">
    <span class="font-medium">Attention Required</span>
    <p>{{ attentionRequired }}</p>
  </div>

  <!-- Widgets Area -->
  <div cdkDropList class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4" (cdkDropListDropped)="drop($event)">
    <!-- KPI Cards -->
    <div *ngFor="let widget of widgets; let i = index" cdkDrag [cdkDragData]="widget" class="widget bg-white p-4 rounded shadow">
      <div class="handle" cdkDragHandle class="cursor-move">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="9" cy="9" r="1"></circle><circle cx="9" cy="15" r="1"></circle><circle cx="15" cy="9" r="1"></circle><circle cx="15" cy="15" r="1"></circle>
        </svg>
      </div>
      <div *ngIf="widget.type === 'card'">
        <h3 class="text-lg font-semibold">{{ widget.name }}</h3>
        <p class="text-2xl">{{ widget.value }}</p>
        <div class="w-full bg-gray-200 rounded-full h-2.5 mt-2">
          <div class="bg-blue-600 h-2.5 rounded-full" [style.width]="calculateProgress(widget.value) + '%'"></div>
        </div>
        <p class="text-sm text-gray-600 mt-1">{{ widget.trend }}</p>
        <div class="h-32 mt-4">
          <canvas [attr.id]="'kpiChart-' + i" #kpiChart></canvas>
        </div>
      </div>
      <div *ngIf="widget.type === 'chart'">
        <h3 class="text-lg font-semibold">{{ widget.name }}</h3>
        <div class="h-48">
          <canvas #performanceTrendChart></canvas>
        </div>
        <p class="text-sm text-gray-600">{{ widget.content }}</p>
      </div>
      <div *ngIf="widget.type === 'list'">
        <h3 class="text-lg font-semibold">{{ widget.name }}</h3>
        <ul>
          <li *ngFor="let item of widget.items" class="flex justify-between items-center py-2">
            <span>{{ item.name }}</span>
            <span class="text-red-600">{{ item.due }}</span>
            <button class="text-blue-600 ml-2">Update</button>
          </li>
        </ul>
      </div>
      <div *ngIf="widget.type === 'summary'">
        <h3 class="text-lg font-semibold">{{ widget.name }}</h3>
        <p class="text-sm text-gray-600">{{ widget.content }}</p>
        <button class="text-blue-600 mt-2">Export Report</button>
      </div>
    </div>
  </div>
</div>